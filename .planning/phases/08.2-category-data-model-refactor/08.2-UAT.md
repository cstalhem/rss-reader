---
status: resolved
phase: 08.2-category-data-model-refactor
source: 08.2-01-SUMMARY.md, 08.2-02-SUMMARY.md, 08.2-03-SUMMARY.md, 08.2-04-SUMMARY.md, 08.2-05-SUMMARY.md
started: 2026-02-17T19:30:00Z
updated: 2026-02-17
---

## Current Test

[testing complete]

## Tests

### 1. Categories tree renders with display names
expected: Open Settings > Categories section. Parent categories show human-readable display names (e.g., "Artificial Intelligence", "Web Development") not kebab-case slugs. Children are nested under their parents with visual indentation.
result: pass

### 2. Category weight change persists
expected: In Categories section, change a category's weight preset (e.g., from normal to boost). The UI updates immediately (optimistic) and the change persists after page refresh.
result: issue
reported: "Not pass, There is still a significant delay from when the category weight button is clicked until the actual visual update."
severity: major

### 3. Create new category
expected: Click the create/add category button in Categories section. Enter a name and submit. The new category appears in the list.
result: pass

### 4. Rename a category
expected: Click the rename (pencil) icon on a category. Enter a new name and confirm. The display name updates immediately.
result: issue
reported: "There is no button to click to rename so there is no way to test this. There should be a button so this is a bug"
severity: major

### 5. Delete a category
expected: Click the delete (trash) icon on a category. Confirm deletion. The category disappears from the tree.
result: issue
reported: "This is the same issue as Test 4. There is no delete-button."
severity: major

### 6. Drag-and-drop reparenting
expected: Drag an ungrouped category onto a parent category. The category moves under that parent as a child. Drag a child category out to the ungrouped zone. It becomes a standalone category.
result: issue
reported: "This does not work. Dragging the child category to the ungroup zone does not ungroup the category from its parent in the UI."
severity: major

### 7. Article list shows display name tags
expected: In the article list, articles show category tags with human-readable display names (e.g., "Machine Learning") not kebab-case slugs (not "machine-learning").
result: pass

### 8. Article reader weight controls
expected: Open an article in the reader drawer. Category tag chips show the category display name and effective weight. Clicking a weight preset on a tag chip changes the weight.
result: issue
reported: "Fail. It's possible to click and select a new weight, but nothing happens when I do that."
severity: major

### 9. New category badge notification
expected: If there are unseen categories (from LLM scoring new articles), the Categories section header shows a count badge. Acknowledging categories (e.g., changing a weight) dismisses the badge.
result: issue
reported: "Fail. Changing the weight does not dismiss the badge. Clicking on the badge does dismiss it as expected, but there is no x icon showing on the chip."
severity: major

### 10. Hide/unhide category
expected: Hide a category from the settings UI. It disappears from the visible list (or moves to a hidden section). Unhiding brings it back.
result: skipped
reason: Not a desired feature — categories are deleted and rediscovered by LLM, not hidden/unhidden

## Summary

total: 10
passed: 3
issues: 6
pending: 0
skipped: 1

## Gaps

- truth: "Category weight change updates UI immediately via optimistic update"
  status: resolved
  reason: "User reported: significant delay from when the category weight button is clicked until the actual visual update"
  severity: major
  test: 2
  root_cause: "Optimistic update in useCategories.ts onMutate correctly updates query data, but React.memo on CategoryTree/CategoryParentRow/CategoryChildRow may prevent re-renders because the categories array reference changes but memo comparison might not detect it. Also, tree-building useMemo in CategoriesSection depends on the categories array — if the reference is the same object identity (setQueryData returning a new array should fix this), the memo won't recompute. Need to verify optimistic path triggers full re-render chain."
  artifacts: [frontend/src/hooks/useCategories.ts, frontend/src/components/settings/CategoriesSection.tsx, frontend/src/components/settings/CategoryTree.tsx]
  missing: []
  debug_session: "a87181b"

- truth: "Rename button (pencil icon) visible on category rows for renaming"
  status: resolved
  reason: "User reported: There is no button to click to rename so there is no way to test this"
  severity: major
  test: 4
  root_cause: "Buttons exist in code but use hover-reveal CSS: maxW={{ base: 'auto', md: '0' }} with _groupHover={{ maxW: '110px' }}. On desktop, buttons are hidden at maxW:0 with overflow:hidden and only appear on row hover via Chakra _groupHover. User did not discover them or hover-reveal is not triggering. Pre-existing pattern from Phase 08.1 (not a regression from 08.2). Fix: make buttons always visible, or add more discoverable interaction."
  artifacts: [frontend/src/components/settings/CategoryChildRow.tsx:183-234, frontend/src/components/settings/CategoryParentRow.tsx]
  missing: []
  debug_session: "a17bad6"

- truth: "Delete button (trash icon) visible on category rows for deletion"
  status: resolved
  reason: "User reported: There is no delete-button (same issue as rename)"
  severity: major
  test: 5
  root_cause: "Same root cause as test 4 — rename and delete buttons share the same hover-reveal Flex wrapper in both CategoryChildRow and CategoryParentRow."
  artifacts: [frontend/src/components/settings/CategoryChildRow.tsx:183-234, frontend/src/components/settings/CategoryParentRow.tsx]
  missing: []
  debug_session: "a17bad6"

- truth: "Dragging a child category to the ungroup zone moves it to root level"
  status: resolved
  reason: "User reported: Dragging the child category to the ungroup zone does not ungroup the category from its parent in the UI"
  severity: major
  test: 6
  root_cause: "CategoryChildRow has both useSortable (id: category.id.toString()) and useDroppable (id: drop:${category.id}). The droppable is only disabled when isDndEnabled=false, NOT when this specific category is being dragged. When dragging a child over the ungroup zone, dnd-kit may detect the child's own droppable as 'over', producing rawOverId='drop:<id>'. After stripping the 'drop:' prefix (line 164), overId matches draggedIdStr, triggering the early return at line 166. Fix: disable the droppable on the currently dragged item."
  artifacts: [frontend/src/components/settings/CategoryChildRow.tsx:58-62, frontend/src/components/settings/CategoriesSection.tsx:147-203]
  missing: []
  debug_session: "a13e018"

- truth: "Clicking a weight preset on a tag chip in article reader changes the category weight"
  status: resolved
  reason: "User reported: It's possible to click and select a new weight, but nothing happens"
  severity: major
  test: 8
  root_cause: "ArticleReader uses standalone useMutation (not useCategories hook) at line 40-47. The mutation calls apiUpdateCategory(categoryId, { weight }) and on success invalidates ['categories'] and ['articles']. Two potential issues: (1) TagChip has dual event handlers — Menu.Root onSelect AND RadioItemGroup onValueChange both call onWeightChange, potentially causing double-fire. (2) Even if mutation succeeds, the article drawer shows data from the article prop passed by parent — the UI won't visually update until articles query refetches and parent re-renders with new article data (no optimistic update on article categories). Needs investigation: add console.log or check network tab to confirm mutation fires."
  artifacts: [frontend/src/components/article/ArticleReader.tsx:40-47, frontend/src/components/article/TagChip.tsx:65-99]
  missing: []
  debug_session: "ad10e8c"

- truth: "Changing a category weight auto-dismisses the new-category badge; badge X icon is visible"
  status: resolved
  reason: "User reported: Changing the weight does not dismiss the badge. Badge X icon not showing on the chip."
  severity: major
  test: 9
  root_cause: "Two separate issues: (1) updateCategoryMutation.onSettled in useCategories.ts only invalidates ['categories'] and ['articles'] — does NOT invalidate ['categories', 'new-count'] and does NOT include is_seen:true in the weight change payload. Weight changes don't acknowledge categories. (2) Badge X icon uses _groupHover with maxW:'0' default — only appears on ROW hover, not on badge hover. The icon is wrapped in a Box with maxW:0 and overflow:hidden, expanding only when the parent row (role=group) is hovered."
  artifacts: [frontend/src/hooks/useCategories.ts:55-58, frontend/src/components/settings/CategoryChildRow.tsx:148-172]
  missing: []
  debug_session: "a9bff95"
