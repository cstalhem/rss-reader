---
phase: 06-ui-theme-polish
plan: 03
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - frontend/src/app/settings/page.tsx
  - frontend/src/components/settings/SettingsSidebar.tsx
  - frontend/src/components/settings/InterestsSection.tsx
  - frontend/src/components/settings/FeedsSection.tsx
  - frontend/src/components/settings/OllamaPlaceholder.tsx
  - frontend/src/components/settings/FeedbackPlaceholder.tsx
autonomous: true

must_haves:
  truths:
    - "Settings page has sidebar navigation on the left with four sections listed"
    - "Clicking a sidebar item switches the visible content section"
    - "On mobile, sidebar disappears and all sections stack vertically"
    - "Interests section contains the existing interests/anti-interests form and category weights"
    - "Feeds section allows adding, removing, and reordering feeds"
    - "Ollama section shows a 'Coming soon' placeholder"
    - "Feedback section shows a 'Coming soon' placeholder"
    - "Switching between sections does not lose unsaved form data in Interests"
  artifacts:
    - path: "frontend/src/app/settings/page.tsx"
      provides: "Settings page with sidebar navigation and section switching"
      contains: "activeSection"
    - path: "frontend/src/components/settings/SettingsSidebar.tsx"
      provides: "Sidebar navigation component with section items"
      contains: "SettingsSection"
    - path: "frontend/src/components/settings/InterestsSection.tsx"
      provides: "Extracted interests and category weights from current settings page"
      contains: "usePreferences"
    - path: "frontend/src/components/settings/FeedsSection.tsx"
      provides: "Feed management in settings (add, delete, reorder)"
      contains: "useFeeds"
    - path: "frontend/src/components/settings/OllamaPlaceholder.tsx"
      provides: "Placeholder section for Phase 7"
      contains: "Coming soon"
    - path: "frontend/src/components/settings/FeedbackPlaceholder.tsx"
      provides: "Placeholder section for Phase 9"
      contains: "Coming soon"
  key_links:
    - from: "frontend/src/app/settings/page.tsx"
      to: "frontend/src/components/settings/SettingsSidebar.tsx"
      via: "activeSection state and onSectionChange callback"
      pattern: "SettingsSidebar"
    - from: "frontend/src/components/settings/InterestsSection.tsx"
      to: "frontend/src/hooks/usePreferences.ts"
      via: "preferences hook for form data and mutations"
      pattern: "usePreferences"
    - from: "frontend/src/components/settings/FeedsSection.tsx"
      to: "frontend/src/hooks/useFeeds.ts"
      via: "feeds hook for feed list data"
      pattern: "useFeeds"
---

<objective>
Restructure the settings page with sidebar navigation and four content sections.

Purpose: The current single-page settings layout mixes interests and categories in one scroll. A sidebar with clear sections (Feeds, Interests, Ollama, Feedback) organizes the growing settings surface and establishes the structure for Phase 7 and Phase 9 to fill in.

Output: Restructured settings/page.tsx, new section components in components/settings/.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-ui-theme-polish/06-CONTEXT.md
@.planning/phases/06-ui-theme-polish/06-RESEARCH.md
@.planning/phases/06-ui-theme-polish/06-01-SUMMARY.md
@frontend/src/app/settings/page.tsx
@frontend/src/hooks/usePreferences.ts
@frontend/src/hooks/useFeeds.ts
@frontend/src/hooks/useFeedMutations.ts
@frontend/src/components/feed/AddFeedDialog.tsx
@frontend/src/components/feed/FeedRow.tsx
@frontend/src/components/feed/DeleteFeedDialog.tsx
@frontend/src/components/layout/Sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create settings sidebar and extract Interests section</name>
  <files>
    frontend/src/components/settings/SettingsSidebar.tsx
    frontend/src/components/settings/InterestsSection.tsx
    frontend/src/components/settings/OllamaPlaceholder.tsx
    frontend/src/components/settings/FeedbackPlaceholder.tsx
    frontend/src/app/settings/page.tsx
  </files>
  <action>
**1. Create SettingsSidebar.tsx:**
A sidebar navigation component for the settings page. Define a type `SettingsSection = "feeds" | "interests" | "ollama" | "feedback"` and export it.

Props: `activeSection: SettingsSection` and `onSectionChange: (section: SettingsSection) => void`.

Render a vertical stack of clickable items, one per section. Each item shows an icon (from react-icons/lu) and label:
- `LuRss` + "Feeds"
- `LuHeart` + "Interests"
- `LuBot` + "Ollama"
- `LuMessageSquare` + "Feedback"

Active item gets `bg="bg.muted"` and `color="fg.default"` with a left accent border (`borderLeftWidth="3px"`, `borderLeftColor="accent.solid"`). Inactive items get `color="fg.muted"` with `_hover={{ bg: "bg.subtle" }}`.

Items should be `cursor="pointer"`, `px={4}`, `py={2.5}`, `borderRadius="md"`, with icon and text in a horizontal Flex with `gap={3}`, `alignItems="center"`.

The sidebar itself should be a `<Stack gap={1}>` with no fixed width (parent controls width).

**2. Create InterestsSection.tsx:**
Extract the existing interests and category weights UI from `settings/page.tsx` into this component. Move the `WEIGHT_OPTIONS` array here.

This component calls `usePreferences()` internally and manages its own form state (`interests`, `antiInterests`) just like the current settings page does. Move the `handleSave`, `handleWeightChange`, `getCategoryWeight` functions and the `useEffect` sync into this component.

Include the loading state: if `isLoading`, show a `<Stack gap={4}>` with 2 `<Skeleton height="120px" variant="shine" />` for the textarea areas and a `<Skeleton height="200px" variant="shine" />` for the categories area. Import `Skeleton` from Chakra.

Include the empty state for categories (the existing "Categories will appear here once articles are scored" box). Enhance it with a `LuTag` icon above the text, matching the empty state pattern from Plan 02 (icon + message, centered).

**3. Create OllamaPlaceholder.tsx:**
A simple placeholder component with:
- `LuBot` icon (boxSize 10, color `fg.subtle`)
- "Ollama Configuration" heading (size `lg`)
- "Coming soon -- configure your Ollama models and connection settings here." text (color `fg.muted`)
- Centered in a `<Flex direction="column" alignItems="center" gap={4} py={16}>`

**4. Create FeedbackPlaceholder.tsx:**
Same pattern as OllamaPlaceholder:
- `LuMessageSquare` icon (boxSize 10, color `fg.subtle`)
- "Feedback Loop" heading (size `lg`)
- "Coming soon -- your feedback will help improve article scoring over time." text (color `fg.muted`)

**5. Restructure settings/page.tsx:**
Replace the entire current content with the sidebar layout pattern from RESEARCH.md:

```tsx
type SettingsSection = "feeds" | "interests" | "ollama" | "feedback";

const [activeSection, setActiveSection] = useState<SettingsSection>("interests");
```

Layout structure:
- `<Box minHeight="100vh" bg="bg">` > `<Header />` > `<Container maxW="5xl" py={8} px={6} pt="88px">`
- Inside Container: `<Flex gap={8}>`
  - Left: sidebar wrapper `<Box display={{ base: "none", md: "block" }} width="200px" flexShrink={0}>` containing `<SettingsSidebar />`
  - Right: `<Box flex={1} minW={0}>`

**Desktop (md+):** Show only the active section. Use CSS `display` toggling to keep all sections mounted (prevents state loss when switching tabs -- per RESEARCH.md pitfall #4). Render all four section components, each wrapped in `<Box display={activeSection === "sectionName" ? "block" : "none"}>`.

**Mobile (base):** Hide sidebar. Stack all sections vertically with `<Stack gap={10}>`. Each section gets a visible heading since there's no sidebar to indicate context.

Remove the loading spinner state from page.tsx -- InterestsSection handles its own loading state now. The page.tsx should just render the layout shell immediately.

Import order: SettingsSidebar, InterestsSection, FeedsSection (Task 2 creates this -- import it but it won't exist yet, so for now import a temporary inline placeholder or import the real component anticipating Task 2). Actually, since both tasks run in sequence within this plan, import FeedsSection anticipating it will exist after Task 2.

Remove all the usePreferences/useState/useEffect/handler code from page.tsx -- it all moved to InterestsSection.tsx. The page.tsx should only have useState for activeSection and import/render the section components.
  </action>
  <verify>Run `cd /Users/cstalhem/projects/rss-reader/frontend && npx tsc --noEmit` -- may have errors from FeedsSection import not yet existing. That's expected and will resolve after Task 2. Verify all 4 new component files exist in components/settings/.</verify>
  <done>Settings page has sidebar navigation with 4 sections. Interests section extracted with its own loading state. Ollama and Feedback show "Coming soon" placeholders. Sections stay mounted on desktop to preserve form state. Mobile stacks all sections vertically.</done>
</task>

<task type="auto">
  <name>Task 2: Create Feeds section for settings page</name>
  <files>frontend/src/components/settings/FeedsSection.tsx</files>
  <action>
Create FeedsSection.tsx -- a self-contained feed management section for the settings page.

This component provides a more spacious feed management experience than the compact sidebar. It reuses the existing hooks (`useFeeds`, `useAddFeed`, `useDeleteFeed`, `useUpdateFeed`, `useReorderFeeds`) and dialog components (`AddFeedDialog`, `DeleteFeedDialog`) but with a different layout.

**Structure:**
1. Section heading: "Feeds" (Heading size `lg`, mb 6)
2. "Add Feed" button at the top right (Button with `colorPalette="accent"`, onClick opens AddFeedDialog)
3. Feed list: each feed as a row with:
   - Feed title (Text, fontWeight medium)
   - Feed URL below title (Text, fontSize sm, color fg.muted, truncated)
   - Unread count badge (Badge, colorPalette accent, only if > 0)
   - Action buttons: rename (inline edit or just a small edit icon for now -- keep it simple, just show the title as an editable Input on click), delete (icon button with LuTrash2, confirms via DeleteFeedDialog)
4. Drag-to-reorder: Use the same DndContext/SortableContext pattern from Sidebar.tsx. Import from @dnd-kit/core and @dnd-kit/sortable. Each feed row is a sortable item with a drag handle (LuGripVertical icon).
5. Empty state: if no feeds, show icon (LuRss) + "No feeds added yet" + "Add your first RSS feed to get started" + the Add Feed button

**Simplification decisions:**
- Don't build inline rename -- just show feed titles as static text. The existing AddFeedDialog already handles rename on creation, and the sidebar handles rename via context menu. Settings feed list is for overview + delete + reorder.
- Each feed row: `<Flex alignItems="center" gap={3} p={3} bg="bg.subtle" borderRadius="md" borderWidth="1px" borderColor="border.subtle">` with drag handle, title, URL, unread badge, delete button.
- Use `useSortable` from @dnd-kit/sortable for each row (same pattern as FeedRow.tsx in the sidebar -- check its implementation for the sortable pattern).

**Toast feedback:**
- On successful feed add (via AddFeedDialog onClose after success): no additional toast needed -- AddFeedDialog handles its own success flow
- On feed delete: add `onSuccess` toast via DeleteFeedDialog's onConfirm handler -- "Feed removed" success toast using `toaster.create()`
- Import `toaster` from `@/components/ui/toaster`

**State management:**
- `const [showAddDialog, setShowAddDialog] = useState(false)` for the AddFeedDialog
- `const [feedToDelete, setFeedToDelete] = useState<Feed | null>(null)` for the DeleteFeedDialog
- Feed list data from `useFeeds()`
- Reorder with `useReorderFeeds()` and the same `handleDragEnd` pattern from Sidebar.tsx

**Loading state:**
- If `isLoading` from useFeeds, show 3 skeleton rows matching the feed row layout

Keep this component self-contained. It does NOT affect the existing sidebar feed management -- both coexist.
  </action>
  <verify>Run `cd /Users/cstalhem/projects/rss-reader/frontend && npx tsc --noEmit` to confirm no type errors across the entire settings restructure (page.tsx + all section components).</verify>
  <done>Feeds section in settings allows viewing all feeds, adding new feeds, deleting feeds with confirmation, and drag-to-reorder. Shows feed title, URL, and unread count. Has loading skeletons and empty state. TypeScript clean.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes in frontend directory
- Settings page renders sidebar on desktop with 4 navigation items
- Clicking sidebar items switches visible section
- InterestsSection contains all preferences and category weight management
- FeedsSection shows feed list with add, delete, and reorder functionality
- OllamaPlaceholder and FeedbackPlaceholder show "Coming soon" messages
- Mobile layout stacks all sections vertically without sidebar
- All sections stay mounted on desktop (display toggle, not conditional render)
- No regressions in existing sidebar feed management
</verification>

<success_criteria>
Settings page is reorganized with clear sidebar navigation and four distinct sections. Users can manage feeds directly from settings. The page structure is ready for Phase 7 (Ollama config) and Phase 9 (Feedback loop) to replace placeholders with real content. Form state in Interests is preserved when switching tabs.
</success_criteria>

<output>
After completion, create `.planning/phases/06-ui-theme-polish/06-03-SUMMARY.md`
</output>
