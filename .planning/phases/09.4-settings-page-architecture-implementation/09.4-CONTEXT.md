# Phase 09.4: Settings Page Architecture Implementation - Context

**Gathered:** 2026-02-22
**Status:** Ready for planning

<domain>
## Phase Boundary

Implement settings architecture simplifications identified in the 09.3 audit — shared layout primitives, category section decomposition, Ollama section cleanup, header standardisation, and mobile nav consistency. Frontend settings only (`frontend/src/app/settings/`, `frontend/src/components/settings/`). No new features, no backend changes.

</domain>

<decisions>
## Implementation Decisions

### ModelSelector progress bars (Theme C adjustment)
- Remove all 3 inline progress bars from ModelSelector entirely — the selector should only list fully downloaded models ready for use
- Model list in the selector dropdown should only update after a pull is confirmed complete by Ollama
- When deleting a model that is currently selected (in categorization or scoring config), show a ConfirmDialog warning the user. If confirmed: delete the model and revert the selector to no selection
- This replaces the original SC6 ("use ModelPullProgress compact") — simpler and cleaner

### Category section decomposition (Theme B)
- Full three-part split as proposed in 09.3 findings:
  1. **`useCategoryTree(categories)`** — Extract 4 useMemo computations (tree building, newCategoryIds, hiddenCategories, search filtering) + search state into a custom hook. Pure data logic.
  2. **`useCategoryDialogs()`** — Extract 4 dialog state objects (delete, move, ungroupConfirm, ungroupParentConfirm) and their open/close/confirm handlers into a custom hook.
  3. **`CategoryTreeContext`** — Put action callbacks (weight change, rename, delete, hide, badge dismiss, ungroup) into React context. CategoryTree props reduced from 15 to ~5 (data only). Row component props reduced from 10-12 to 3-5 (via useContext).
- Selection state (selectedIds, onToggleSelection) placement in context vs props is Claude's discretion — do what minimises total props while keeping the code clear

### Claude's Discretion
- Component API shapes for SettingsPanel, EmptyState, SettingsPageHeader (props, slots, children patterns)
- Selection state placement (context vs props) for CategoryTreeContext
- Whether to include newCategoryIds in context or pass as prop
- All other themes (A, D, E) implemented per 09.3 findings without modification

</decisions>

<specifics>
## Specific Ideas

- The ModelSelector behavior change means the component becomes purely a "pick from what's available" selector — no download awareness at all. The ModelManagement panel is the only place downloads are visible.
- The delete-selected-model confirmation dialog should use the project's existing ConfirmDialog component (consistent with the rest of the codebase).

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope.

</deferred>

---

*Phase: 09.4-settings-page-architecture-implementation*
*Context gathered: 2026-02-22*
