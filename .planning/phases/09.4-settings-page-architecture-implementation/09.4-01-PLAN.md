---
phase: 09.4-settings-page-architecture-implementation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/settings/SettingsPanel.tsx
  - frontend/src/components/settings/SettingsPageHeader.tsx
  - frontend/src/components/settings/OllamaSection.tsx
  - frontend/src/components/settings/InterestsSection.tsx
  - frontend/src/components/settings/GeneralSection.tsx
  - frontend/src/components/settings/FeedsSection.tsx
  - frontend/src/components/settings/CategoriesSection.tsx
  - frontend/src/components/settings/FeedbackPlaceholder.tsx
  - frontend/src/components/settings/OllamaPlaceholder.tsx
autonomous: true
requirements: []

must_haves:
  truths:
    - "All settings section cards use SettingsPanel instead of inline Box wrappers"
    - "All settings page headers use SettingsPageHeader with consistent fontSize='xl'"
    - "Empty states use Chakra EmptyState.* primitives instead of custom Flex layouts"
    - "OllamaPlaceholder.tsx is deleted (dead code)"
  artifacts:
    - path: "frontend/src/components/settings/SettingsPanel.tsx"
      provides: "Shared card wrapper component"
      contains: "bg=\"bg.subtle\""
    - path: "frontend/src/components/settings/SettingsPageHeader.tsx"
      provides: "Shared page header component"
      contains: "fontSize=\"xl\""
  key_links:
    - from: "frontend/src/components/settings/OllamaSection.tsx"
      to: "frontend/src/components/settings/SettingsPanel.tsx"
      via: "import"
      pattern: "import.*SettingsPanel"
    - from: "frontend/src/components/settings/FeedsSection.tsx"
      to: "frontend/src/components/settings/SettingsPageHeader.tsx"
      via: "import"
      pattern: "import.*SettingsPageHeader"
---

<objective>
Create shared layout primitives (SettingsPanel, SettingsPageHeader) and migrate all settings sections to use them. Replace inline empty states with Chakra EmptyState components. Delete OllamaPlaceholder dead code.

Purpose: Eliminate duplicated card/header/empty-state patterns across 7+ settings sections, establishing consistent layout primitives (Themes A + D from 09.3 findings).
Output: Two new shared components, all settings sections migrated, one dead file deleted.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09.4-settings-page-architecture-implementation/09.4-RESEARCH.md

@frontend/src/components/settings/OllamaSection.tsx
@frontend/src/components/settings/InterestsSection.tsx
@frontend/src/components/settings/GeneralSection.tsx
@frontend/src/components/settings/FeedsSection.tsx
@frontend/src/components/settings/CategoriesSection.tsx
@frontend/src/components/settings/FeedbackPlaceholder.tsx
@frontend/src/components/settings/OllamaPlaceholder.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SettingsPanel and SettingsPageHeader shared components</name>
  <files>
    frontend/src/components/settings/SettingsPanel.tsx
    frontend/src/components/settings/SettingsPageHeader.tsx
  </files>
  <action>
Create two new shared components:

**SettingsPanel.tsx** — A simple Box wrapper with default card styling. Accepts `BoxProps` spread so callers can override `bg`, `borderRadius`, `p`, etc. Default: `bg="bg.subtle"`, `borderRadius="md"`, `borderWidth="1px"`, `borderColor="border.subtle"`, `p={6}`. Mark as `"use client"` since it renders inside client components.

**SettingsPageHeader.tsx** — A `"use client"` component for consistent section headers. Props: `title: string`, `titleBadge?: ReactNode` (optional badge next to title, e.g. "N new" in Categories), `children?: ReactNode` (optional right-side content like buttons/badges). Layout: `Flex alignItems="center" gap={2}` with `Text fontSize="xl" fontWeight="semibold"` for title, titleBadge after title, then `{children && <Box flex={1} />}` spacer, then children on the right.

See RESEARCH.md Patterns 4 and 6 for exact APIs.
  </action>
  <verify>
Both files exist and export their components. TypeScript compiles: `cd frontend && bunx tsc --noEmit --pretty 2>&1 | head -30`
  </verify>
  <done>SettingsPanel.tsx and SettingsPageHeader.tsx exist with correct APIs</done>
</task>

<task type="auto">
  <name>Task 2: Migrate all settings sections to shared primitives and delete dead code</name>
  <files>
    frontend/src/components/settings/OllamaSection.tsx
    frontend/src/components/settings/InterestsSection.tsx
    frontend/src/components/settings/GeneralSection.tsx
    frontend/src/components/settings/FeedsSection.tsx
    frontend/src/components/settings/CategoriesSection.tsx
    frontend/src/components/settings/FeedbackPlaceholder.tsx
    frontend/src/components/settings/OllamaPlaceholder.tsx
  </files>
  <action>
Migrate each section to use the new shared components. For each file:

**OllamaSection.tsx:**
- Replace the header `Flex` containing `Text fontSize="xl"` + `OllamaHealthBadge` with `<SettingsPageHeader title="Ollama"><OllamaHealthBadge ... /></SettingsPageHeader>`
- Replace all 3 inline card `Box bg="bg.subtle" borderRadius="md" borderWidth="1px" ...` wrappers with `<SettingsPanel>`
- Replace the disconnected empty state `Flex` with Chakra `EmptyState.Root > EmptyState.Content > EmptyState.Indicator + EmptyState.Description` (icon: `LuServerOff`, keep existing description text). Import `EmptyState` from `@chakra-ui/react`.

**InterestsSection.tsx (InterestsForm):**
- Replace header `Text fontSize="xl"` with `<SettingsPageHeader title="Interest Preferences" />`
- Replace card `Box` wrapper with `<SettingsPanel>`

**GeneralSection.tsx:**
- Replace header `Text fontSize="lg"` with `<SettingsPageHeader title="General" />`
- Replace card `Box bg="bg.panel"` wrapper with `<SettingsPanel bg="bg.panel" borderRadius="lg" p={5}>` (override defaults to match current styling)

**FeedsSection.tsx:**
- Replace header `Flex` with `<SettingsPageHeader title="Feeds"><Button ...>Add Feed</Button></SettingsPageHeader>`
- Replace empty state `Flex` with Chakra `EmptyState.Root > EmptyState.Content > EmptyState.Indicator(LuRss) + VStack > EmptyState.Title + EmptyState.Description + Button`. Keep existing text and action button.

**CategoriesSection.tsx:**
- Replace header `Flex` containing title + badge + CreateCategoryPopover with `<SettingsPageHeader title="Topic Categories" titleBadge={newCount badge or undefined}><CreateCategoryPopover .../></SettingsPageHeader>`
- Replace empty state `Flex` with Chakra `EmptyState.Root > EmptyState.Content > EmptyState.Indicator(LuTag) + EmptyState.Description`. Keep existing text.

**FeedbackPlaceholder.tsx:**
- Replace custom `Flex` centered layout with Chakra `EmptyState.Root > EmptyState.Content > EmptyState.Indicator(LuMessageSquare) + VStack > EmptyState.Title + EmptyState.Description`. No SettingsPageHeader here — the EmptyState IS the full section.

**OllamaPlaceholder.tsx:**
- DELETE this file entirely. It is dead code (confirmed in 09.3 audit). Verify no imports reference it first with a grep.

Import `EmptyState` and `VStack` from `@chakra-ui/react` (not from `@/components/ui/`). Per RESEARCH.md Pitfall 5.

Clean up unused imports in each modified file (remove old `Box` import if no longer needed, etc.).
  </action>
  <verify>
Run `cd frontend && bunx tsc --noEmit --pretty 2>&1 | head -40` to confirm no type errors. Run `cd frontend && bun run lint 2>&1 | tail -20` for lint. Grep for OllamaPlaceholder imports: `grep -r "OllamaPlaceholder" frontend/src/` should return nothing. Run `cd frontend && bun run build 2>&1 | tail -10` to confirm production build succeeds.
  </verify>
  <done>All 6 settings sections use SettingsPanel and/or SettingsPageHeader. All 4 inline empty states replaced with Chakra EmptyState. OllamaPlaceholder.tsx deleted with no dangling imports. Build passes.</done>
</task>

</tasks>

<verification>
1. `cd frontend && bun run build` completes without errors
2. `grep -r "OllamaPlaceholder" frontend/src/` returns no results
3. Spot-check: OllamaSection.tsx, FeedsSection.tsx, CategoriesSection.tsx all import SettingsPanel and/or SettingsPageHeader
4. No inline `Box bg="bg.subtle" borderRadius="md" borderWidth="1px"` card wrappers remain in modified files
</verification>

<success_criteria>
- SettingsPanel used across all settings sections that have card wrappers (SC1)
- EmptyState components replace inline empty states (SC2)
- SettingsPageHeader standardises all page headers with fontSize="xl" (SC7)
- OllamaPlaceholder dead code deleted (SC10)
- Frontend builds and passes lint (SC11)
</success_criteria>

<output>
After completion, create `.planning/phases/09.4-settings-page-architecture-implementation/09.4-01-SUMMARY.md`
</output>
