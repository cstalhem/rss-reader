---
phase: 08.1-categories-settings-ui-redesign
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/settings/CategoryTree.tsx
  - frontend/src/components/settings/CategoryParentRow.tsx
  - frontend/src/components/settings/CategoryChildRow.tsx
  - frontend/src/components/settings/WeightPresetStrip.tsx
autonomous: true
requirements: [CATGRP-01, CATGRP-02, CATGRP-03]
gap_closure: true

must_haves:
  truths:
    - "Vertical connector lines between child rows are continuous with no gaps"
    - "Row action icons (rename, delete) appear on hover with smooth animation and reserve no space when hidden"
    - "Weight preset buttons are compact and proportional to row height"
  artifacts:
    - path: "frontend/src/components/settings/CategoryTree.tsx"
      provides: "Gap-free connector lines between child rows"
      contains: "calc"
    - path: "frontend/src/components/settings/CategoryParentRow.tsx"
      provides: "Max-width animated action icons that collapse when hidden"
      contains: "maxW"
    - path: "frontend/src/components/settings/CategoryChildRow.tsx"
      provides: "Max-width animated action icons that collapse when hidden"
      contains: "maxW"
    - path: "frontend/src/components/settings/WeightPresetStrip.tsx"
      provides: "Compact weight preset buttons with explicit padding override"
      contains: "p="
  key_links:
    - from: "CategoryTree.tsx"
      to: "CategoryChildRow.tsx"
      via: "CSS connector pseudo-elements bridging Stack gap"
      pattern: "calc.*100%.*\\+"
---

<objective>
Fix three visual/cosmetic gaps from UAT round 2: connector line gaps between child rows, action icon hover behavior and space reservation, and oversized weight preset buttons.

Purpose: Close visual polish gaps identified in UAT R2 tests 1, 9, and 2.
Output: Polished tree view with continuous connector lines, animated hover-reveal action icons, and compact weight buttons.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08.1-categories-settings-ui-redesign/08.1-08-SUMMARY.md
@frontend/src/components/settings/CategoryTree.tsx
@frontend/src/components/settings/CategoryParentRow.tsx
@frontend/src/components/settings/CategoryChildRow.tsx
@frontend/src/components/settings/WeightPresetStrip.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix connector line gaps and action icon hover behavior</name>
  <files>
    frontend/src/components/settings/CategoryTree.tsx
    frontend/src/components/settings/CategoryParentRow.tsx
    frontend/src/components/settings/CategoryChildRow.tsx
  </files>
  <action>
**CategoryTree.tsx — Fix connector line gaps (Gap 1):**

The `Stack gap={1}` (4px) between child rows creates gaps that vertical connector pseudo-elements don't bridge. Each child's `_before` vertical line covers only its own height.

Fix: Extend the vertical connector line height to bridge the gap. Change the `_before` pseudo-element `height` from:
- Non-last child: `"100%"` to `"calc(100% + 4px)"` (bridges the 4px gap to next sibling)
- Last child: `"50%"` stays as-is (no gap below last child)

**CategoryParentRow.tsx — Fix action icon hover (Gap 2):**

The action icons use `opacity={{ base: 1, md: 0 }}` with `_groupHover={{ opacity: 1 }}`. The media query has higher CSS specificity than the `_groupHover` pseudo-class, so icons stay invisible on desktop. Additionally, opacity-only hiding still reserves layout space.

Fix: Replace the opacity-based approach with the same `maxWidth` collapse pattern used by `WeightPresetStrip`:

1. Wrap both action IconButtons (rename + delete) in a single `Flex` container
2. On that `Flex`, use:
   - `overflow="hidden"`
   - `maxW={{ base: "auto", md: "0" }}`
   - `_groupHover={{ maxW: "80px" }}` (enough for 2 buttons)
   - `transition="max-width 0.2s ease-out"`
3. Remove the per-button `opacity`/`_groupHover`/`transition` props
4. Keep `display={{ base: "flex", md: ... }}` patterns for mobile (always visible on mobile)

**CategoryChildRow.tsx — Fix action icon hover (Gap 2):**

Apply the same fix as CategoryParentRow. The child row has three action icons: rename, delete, and hide.

1. Wrap all three action IconButtons (rename, delete, hide) in a single `Flex` container
2. On that container:
   - `overflow="hidden"`
   - `maxW={{ base: "auto", md: "0" }}`
   - `_groupHover={{ maxW: "110px" }}` (enough for 3 buttons)
   - `transition="max-width 0.2s ease-out"`
3. Remove per-button `opacity`/`_groupHover`/`transition` props from all three buttons
4. Move the hide button (currently outside the `!isRenaming` conditional) inside the wrapper

Note: The hide button is currently rendered outside the `!isRenaming` block. Move it inside the wrapper so ALL action buttons animate together.
  </action>
  <verify>
Run `cd /Users/cstalhem/projects/rss-reader/frontend && npx tsc --noEmit` to verify no type errors. Visually: connector lines should have no gaps between child rows; action icons should not reserve space and should smoothly expand on row hover.
  </verify>
  <done>
Connector lines between child rows are continuous with no gaps. Action icons on all row types appear smoothly on hover via max-width animation and reserve no space when collapsed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Reduce weight preset button size</name>
  <files>
    frontend/src/components/settings/WeightPresetStrip.tsx
  </files>
  <action>
**WeightPresetStrip.tsx — Compact button size (Gap 5):**

Chakra `size='xs'` IconButton renders ~32px tall due to default internal padding. The `minW="28px"` only constrains width.

Fix: Add explicit compact sizing to each IconButton in the WEIGHT_OPTIONS map:
1. Add `p="4px"` to override Chakra's default xs padding
2. Add `h="24px"` and `minW="24px"` (replacing the current `minW="28px"`) for a tighter overall footprint
3. Reduce icon size from `14` to `12` to match the smaller button
4. Update the inactive icon wrapper `maxW` from `"28px"` to `"24px"` to match new button size
5. Update the reset button container `w` from `"28px"` to `"24px"`
  </action>
  <verify>
Run `cd /Users/cstalhem/projects/rss-reader/frontend && npx tsc --noEmit` to verify no type errors. Weight preset buttons should render at ~24px height, visibly smaller than before.
  </verify>
  <done>
Weight preset buttons are compact at ~24px, proportional to the category row height, with no excess padding.
  </done>
</task>

</tasks>

<verification>
1. `cd /Users/cstalhem/projects/rss-reader/frontend && npx tsc --noEmit` — no TypeScript errors
2. `cd /Users/cstalhem/projects/rss-reader/frontend && bun run build` — production build succeeds
3. Visual check: tree connector lines continuous, action icons animate on hover without reserving space, weight buttons compact
</verification>

<success_criteria>
- Connector lines between child rows show no gaps (4px Stack gap bridged by extended pseudo-element height)
- Action icons (rename, delete, hide) are invisible and take no space by default, smoothly expand on row hover
- Weight preset buttons render at ~24px instead of ~32px
- No TypeScript or build errors introduced
</success_criteria>

<output>
After completion, create `.planning/phases/08.1-categories-settings-ui-redesign/08.1-09-SUMMARY.md`
</output>
