# Phase 08.1: Categories Settings UI Redesign - Context

**Gathered:** 2026-02-17
**Status:** Ready for planning

<domain>
## Phase Boundary

Redesign the categories settings panel to replace the accordion-based group layout with a tree view. The accordion pattern has fundamental DnD incompatibility (collapsed groups create zero-dimension drop targets). This phase also transitions from a "groups contain categories" model to a "categories can contain categories" parent-child model, adds manual category creation, seeded base categories, and LLM-aware hierarchy assignment.

</domain>

<decisions>
## Implementation Decisions

### Layout paradigm
- **Tree view** with always-expanded parent-child hierarchy (no collapse)
- CSS-drawn connector lines between parent and children (vertical + horizontal lines, not ASCII characters)
- Parent categories distinguished by a folder icon + slightly bolder text
- Child categories indented with tree connector lines (similar to `├──` and `└──` visual pattern but rendered via CSS borders/pseudo-elements)
- Maximum 2 levels of nesting for now (parent > child), but design data model to support deeper nesting later
- All categories sorted alphabetically within their level

### Data model change
- **Categories-as-parents**: Remove the separate "group" concept entirely. Categories can have child categories
- Any ungrouped (root-level) category can become a parent by having children dragged onto it
- Parent categories have their own score weight AND act as the default weight for children
- Child categories inherit parent weight unless explicitly overridden
- Three-tier weight resolution remains: explicit override > parent weight > default normal (1.0)
- Inherited weights displayed slightly dimmer than overridden weights on child categories

### Weight presets interaction
- **Collapsed by default**: Each row shows only the currently selected weight (as an icon)
- **Hover expands**: On hover, the full set of weight icons slides in from the right, with the active icon smoothly moving to its correct position in the set
- **Desktop**: Weight icons have hover tooltips spelling out the weight name
- **Mobile**: Weight icons show text labels alongside them (since no hover)
- Research needed: exact icon choices for block/reduce/normal/boost/max

### Category assignment (DnD)
- **Drag-and-drop** for moving categories between parents, kept as the primary interaction
- Drop targets: root level (ungrouped area), existing parent categories (categories that already have children), and any ungrouped root-level category (which becomes a parent upon receiving a child)
- Cannot drop onto a leaf category that is already a child of a parent — must first drag it to root level to make it eligible as a parent
- Children can be moved directly between existing parents
- **Drop feedback**: valid targets get a highlight, ghost preview shows where the category would land in the tree
- DnD disabled when search filter is active
- **DnD library**: Research needed — evaluate @dnd-kit vs @hello-pangea/dnd vs alternatives for tree layout suitability

### Category management
- **Manual category creation**: Header action button opens popover/dialog to name a new category. Created at root level as an ungrouped leaf
- **Renaming**: Desktop hover reveals edit button; mobile uses right-to-left swipe gesture to reveal edit button. No reserved space for hidden icons
- **Deleting a parent**: Children become ungrouped (released to root level). Confirmation dialog shows impact
- **Deleting any category**: Both LLM-discovered and manually-created categories can be deleted. No blocklisting — deleted categories may return if the LLM discovers them again
- **New category badges**: Existing "new" category marking behavior preserved
- **LLM auto-assignment**: New categories discovered by the LLM can be automatically assigned to a parent based on the existing hierarchy (LLM categorization prompt includes the tree structure)

### Seeded base categories
- 8-10 broad top-level parent categories seeded on new installs (e.g., Technology, Science, Business, Entertainment, etc.)
- Seeded before any LLM scoring — categories exist even on a fresh install
- LLM can assign discovered categories as children of seeded parents

### Density & scrolling
- Full page scroll for settings content — no fixed-height container for the tree
- Sidebar remains fixed/visible at all times (existing behavior, enforce across all settings pages)
- Child rows slightly more compact than parent rows, with spacing easy to adjust
- **Search bar** at the top of the category tree for filtering by name. DnD disabled while search is active

### Claude's Discretion (research-driven)
- DnD library selection (evaluate options during research phase)
- Code architecture and component composition patterns (research Next.js best practices for complex interactive settings UIs)
- Exact icon choices for weight presets (block/reduce/normal/boost/max)
- Exact seeded category list (8-10 broad parents)
- CSS implementation details for tree connector lines
- Swipe gesture library/approach for mobile edit reveal
- Weight icon slide-in animation implementation details
- Search bar placement and filter behavior details

</decisions>

<specifics>
## Specific Ideas

- Tree connectors should look like `├──` and `└──` but rendered with CSS borders, not text characters
- "I want categories themselves to be the hierarchy — not groups as separate containers"
- Weight preset animation: collapsed pill showing active weight, expanding on hover to reveal all options with the active icon gliding to its position
- Seeded categories give new users something to see immediately instead of an empty state

</specifics>

<deferred>
## Deferred Ideas

- Deeper nesting beyond 2 levels — design data model to support it, but don't implement deeper nesting in this phase
- Collapsible tree nodes — may be needed later for very long category lists, but keeping always-expanded for now
- Context menu / right-click "Move to..." as DnD alternative — possible future enhancement for accessibility

</deferred>

---

*Phase: 08.1-categories-settings-ui-redesign*
*Context gathered: 2026-02-17*
