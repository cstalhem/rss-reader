# Phase 9.2: Frontend DOM Tree Simplification - Context

**Gathered:** 2026-02-20
**Status:** Ready for planning

<domain>
## Phase Boundary

Reduce DOM complexity across the frontend — eliminate responsive duplication, use semantic HTML, route-based settings navigation, and ensure every rendered node serves a purpose. No new features or capabilities.

</domain>

<decisions>
## Implementation Decisions

### Settings Navigation
- Nested route segments: `app/settings/feeds/page.tsx`, `app/settings/categories/page.tsx`, etc. — each section is its own page file
- `/settings` (no section) redirects to first section (e.g., `/settings/feeds`)
- Desktop: persistent left sidebar panel (always visible at md+, content fills remaining space)
- Mobile: dropdown at top of content area replaces sidebar below md breakpoint (~768px)
- Sidebar uses `<nav>` with proper link elements, not `<div>` with click handlers
- Only the active section is mounted in the DOM — inactive sections are not rendered

### Category Row Shared Shell
- Extract a `CategoryRowShell` component for common wrapper, responsive strip placement, rename state, and context menu logic
- All three row types (CategoryParentRow, CategoryChildRow, CategoryUngroupedRow) use the shared shell — thin wrappers supply their unique bits (chevron/folder for parent, checkbox for child, etc.)
- Keep tree connector lines (CSS pseudo-elements) — visual hierarchy is valuable, minimal node cost
- Single `WeightPresetStrip` per row that adapts responsively (no mobile/desktop duplicate)

### WeightPresetStrip Tooltips
- Tooltip wraps each weight button with `disabled` prop tied to breakpoint hook
- At md+: Tooltip active — shows label on hover for icon-only desktop buttons
- Below md: Tooltip disabled (no-op, no extra wrapper nodes) — visible text label next to icon serves the same purpose
- `aria-label` on Button in all cases for accessibility
- Keep hover-expand interaction on desktop (compact default, expands on hover). Mobile shows all buttons always.

### Responsive Dedup Strategy
- Per-case approach based on weight of duplicated subtree:
  - **CSS `display: none`** for lightweight elements (~1-3 nodes): Header mobile button, small toggles
  - **Conditional rendering** for heavy subtrees: category row strips (via shared shell), settings mobile/desktop stacks (eliminated by route-based navigation)
  - **Claude's discretion** for borderline cases (~10-15 nodes): CategoryActionBar mobile/desktop
- No blanket rule — decide per-component based on DOM cost vs FOUC risk

### Semantic HTML Audit
- Full systematic audit across all pages — not just targeted changes
- Includes app shell landmarks: Header → `<header>`, Sidebar → `<nav>`/`<aside>`, main content → `<main>`
- Page-level semantics: article lists use `<article>`, settings sections use appropriate elements
- Replace divs with semantic elements wherever appropriate

### Article List Cleanup
- ScoreBadge: replace Tooltip wrapper with `aria-label` (saves 2 DOM nodes per article row)
- No empty containers rendered when content is absent (e.g., scoring indicator area when not scoring)

### Priority & Phasing
- Claude decides workstream ordering based on dependency graph and risk
- Claude decides plan grouping based on parallelization opportunities
- No hard DOM node count target — reduce waste wherever found, measure before/after
- Before/after DOM snapshots (via Rodney) to verify reduction — concrete evidence of improvement

### Claude's Discretion
- Workstream ordering and plan grouping
- CategoryActionBar responsive dedup approach (conditional render vs CSS hide)
- Exact CategoryRowShell interface design
- Specific semantic HTML element choices per component
- Any additional wrapper node removal discovered during audit

</decisions>

<specifics>
## Specific Ideas

- WeightPresetStrip should use breakpoint-disabled Tooltip pattern: one render path, Tooltip active at md+ for icon discovery, disabled below md where text labels are visible
- Shared shell for category rows should be DRY but not over-abstract — each row type's unique elements (checkbox, chevron, folder icon) should be clearly visible in the thin wrapper, not buried in config objects
- Before/after DOM snapshots on: article list page (50 articles), settings page (feeds tab + categories tab)

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 09.2-frontend-dom-tree-simplification-and-component-structure-optimization*
*Context gathered: 2026-02-20*
