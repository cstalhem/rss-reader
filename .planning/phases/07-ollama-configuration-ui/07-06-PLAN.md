---
phase: 07-ollama-configuration-ui
plan: 06
type: execute
wave: 2
depends_on: []
files_modified:
  - frontend/src/components/settings/ModelSelector.tsx
  - frontend/src/components/settings/ModelManagement.tsx
  - frontend/src/components/settings/OllamaSection.tsx
  - frontend/src/components/settings/SettingsSidebar.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Model selector uses Chakra UI Select component instead of NativeSelect"
    - "Disconnected state shows centered empty-state design with large icon and text"
    - "Sidebar download indicator uses download icon instead of dot"
    - "Ollama settings page uses distinct panels for each section with descriptive names"
  artifacts:
    - path: frontend/src/components/settings/ModelSelector.tsx
      provides: "Chakra Select.Root/Trigger/Content for model dropdowns"
      contains: "Select.Root"
    - path: frontend/src/components/settings/ModelSelector.tsx
      provides: "Centered empty state for disconnected Ollama"
      contains: "Flex.*direction=\"column\".*alignItems=\"center\""
    - path: frontend/src/components/settings/ModelManagement.tsx
      provides: "Centered empty state for disconnected Ollama"
      contains: "Flex.*direction=\"column\".*alignItems=\"center\""
    - path: frontend/src/components/settings/OllamaSection.tsx
      provides: "Distinct panel sections with bg.subtle and borderRadius"
      contains: "bg=\"bg.subtle\""
    - path: frontend/src/components/settings/SettingsSidebar.tsx
      provides: "Download icon indicator for active downloads"
      contains: "LuDownload"
  key_links:
    - from: frontend/src/components/settings/ModelSelector.tsx
      to: "Chakra UI Select"
      via: "Select.Root with Portal > Positioner > Content"
      pattern: "Select\\.Root"
    - from: frontend/src/components/settings/OllamaSection.tsx
      to: "child section components"
      via: "Stack with gap containing paneled sections"
      pattern: "Stack.*gap"
---

<objective>
Polish Ollama settings UI with Chakra Select components, improved empty states, and distinct panel sections matching Feeds page design.

Purpose: Addresses Gaps 1, 2, 5, and 6 — cosmetic and minor UI refinements for consistency, better UX, and visual hierarchy.
Output: Professional, consistent UI following established design patterns.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-ollama-configuration-ui/07-01-SUMMARY.md
@.planning/phases/07-ollama-configuration-ui/07-02-SUMMARY.md
@frontend/src/components/settings/FeedsSection.tsx
@frontend/src/theme/index.ts

Reference FeedsSection.tsx for empty state design pattern (centered Flex with icon + text).

From AGENTS.md:
> Chakra UI v3 — Portal/Positioner pattern (REQUIRED for overlays): Select, Menu, Tooltip, and Popover components MUST use `Portal > Component.Positioner > Component.Content`. Without this, dropdowns render inline and cause layout shift. See `SortSelect.tsx` and `TagChip.tsx` for correct examples.
</context>

<tasks>

<task type="auto">
  <name>Replace NativeSelect with Chakra Select in ModelSelector</name>
  <files>frontend/src/components/settings/ModelSelector.tsx</files>
  <action>
Replace NativeSelect.Root/NativeSelect.Field components with Chakra UI Select using the Portal/Positioner pattern.

Current code (lines ~80-100):
```tsx
<NativeSelect.Root>
  <NativeSelect.Field>...</NativeSelect.Field>
</NativeSelect.Root>
```

Replace with:
```tsx
<Select.Root value={selectedModel} onValueChange={handleChange}>
  <Select.Trigger>
    <Select.ValueText placeholder="Select model" />
  </Select.Trigger>
  <Portal>
    <Select.Positioner>
      <Select.Content>
        {models.map(model => (
          <Select.Item key={model.name} value={model.name}>
            <Select.ItemText>{formatModelDisplay(model)}</Select.ItemText>
          </Select.Item>
        ))}
      </Select.Content>
    </Select.Positioner>
  </Portal>
</Select.Root>
```

Apply to both single model selector and split model selectors (categorization/scoring).

Import Select from Chakra UI and Portal from the correct location. Reference SortSelect.tsx or TagChip.tsx for correct Portal pattern.

Preserve existing:
- Model name + size formatting
- (loaded) indicator logic
- Disabled state when disconnected
- onChange handlers
  </action>
  <verify>
1. Navigate to Settings > Ollama with models available
2. Click model dropdown
3. Expected: Chakra-styled dropdown appears as overlay (not inline)
4. Dropdown shows model name, size, and (loaded) indicator for loaded models
5. Selecting a model updates the selection
6. Enable "Use separate models" toggle
7. Both dropdowns (Categorization, Scoring) use same Chakra Select styling
8. Dropdowns don't cause layout shift when opened
  </verify>
  <done>Model selector uses Chakra Select.Root with Portal/Positioner pattern, matching project UI standards</done>
</task>

<task type="auto">
  <name>Implement centered empty state for disconnected Ollama</name>
  <files>frontend/src/components/settings/ModelSelector.tsx, frontend/src/components/settings/ModelManagement.tsx</files>
  <action>
Replace disconnected text messages with centered empty state design matching FeedsSection.tsx pattern.

Reference design (FeedsSection.tsx empty state):
```tsx
<Flex
  direction="column"
  alignItems="center"
  justifyContent="center"
  gap={4}
  py={16}
  px={8}
  bg="bg.subtle"
  borderRadius="md"
  borderWidth="1px"
  borderColor="border.subtle"
>
  <LuRss size={40} color="var(--chakra-colors-fg-subtle)" />
  <Text fontSize="lg" color="fg.muted" textAlign="center">
    No feeds added yet
  </Text>
  <Text fontSize="sm" color="fg.muted" textAlign="center">
    Add your first RSS feed to get started
  </Text>
</Flex>
```

Apply to both components:

**ModelSelector.tsx** (disconnected state):
- Icon: LuServerOff (server disconnected icon)
- Primary text: "Ollama is not connected"
- Secondary text: "Start Ollama to select models"

**ModelManagement.tsx** (disconnected state):
- Icon: LuServerOff
- Primary text: "Ollama is not connected"
- Secondary text: "Start Ollama to manage models"

Use same spacing, colors, and layout as FeedsSection empty state.
  </action>
  <verify>
1. Stop Ollama service (or configure invalid Ollama host in backend config)
2. Navigate to Settings > Ollama
3. Expected: Health badge shows "Disconnected"
4. Both ModelSelector and ModelManagement sections show centered empty states
5. Empty states have:
   - Large server icon at top
   - Primary text below icon
   - Secondary explanatory text below that
   - Subtle background with border
   - Generous padding
6. Design matches Feeds empty state exactly (same spacing, colors, layout)
  </verify>
  <done>Disconnected Ollama state shows centered empty-state design with icon and text, matching Feeds section pattern</done>
</task>

<task type="auto">
  <name>Update sidebar download indicator and add panel sections to OllamaSection</name>
  <files>frontend/src/components/settings/SettingsSidebar.tsx, frontend/src/components/settings/OllamaSection.tsx</files>
  <action>
**Part 1: Sidebar download indicator (SettingsSidebar.tsx lines 73-81)**

Replace pulsing 6px dot with LuDownload icon that pulses:

Current:
```tsx
<Box w={2} h={2} borderRadius="full" bg="accent.solid" animation={pulseAnimation} />
```

Replace with:
```tsx
<LuDownload size={16} color="var(--chakra-colors-accent-solid)" style={{ animation: pulseAnimation }} />
```

Keep existing pulse animation, just apply to icon instead of dot.

**Part 2: Panel sections (OllamaSection.tsx)**

Wrap each major section in distinct panels with bg.subtle, borderRadius, padding, and borderWidth.

Structure:
```tsx
<Stack gap={6}>
  {/* Panel 1: Model Configuration */}
  <Box bg="bg.subtle" borderRadius="md" borderWidth="1px" borderColor="border.subtle" p={6}>
    <Text fontSize="lg" fontWeight="semibold" mb={4}>Model Configuration</Text>
    <ModelSelector ... />
    <RescoreButton ... />
  </Box>

  {/* Panel 2: Model Library */}
  <Box bg="bg.subtle" borderRadius="md" borderWidth="1px" borderColor="border.subtle" p={6}>
    <Text fontSize="lg" fontWeight="semibold" mb={4}>Model Library</Text>
    <ModelManagement ... />
  </Box>

  {/* Panel 3: System Prompts */}
  <Box bg="bg.subtle" borderRadius="md" borderWidth="1px" borderColor="border.subtle" p={6}>
    <Text fontSize="lg" fontWeight="semibold" mb={4}>System Prompts</Text>
    <SystemPrompts ... />
  </Box>
</Stack>
```

Section names:
1. "Model Configuration" — for model selector, save button, re-evaluate button
2. "Model Library" — for curated models, custom model input, pull/delete actions
3. "System Prompts" — for categorization and scoring prompt display

Match Feeds page panel design (check FeedsSection.tsx for exact styling).
  </action>
  <verify>
1. Start a model download
2. Check sidebar: Ollama item shows pulsing download icon (LuDownload), not dot
3. Navigate to Settings > Ollama
4. Page shows three distinct panels with subtle backgrounds:
   - "Model Configuration" panel at top
   - "Model Library" panel in middle
   - "System Prompts" panel at bottom
5. Each panel has:
   - Section heading in larger, semibold font
   - Consistent padding
   - Subtle background and border
   - Proper spacing between panel content and edges
6. Design matches Feeds section panel styling
  </verify>
  <done>Sidebar uses download icon indicator and Ollama settings page has distinct panels with descriptive section names</done>
</task>

</tasks>

<verification>
1. Model dropdowns use Chakra Select with proper Portal/Positioner pattern (gap closed)
2. Disconnected state shows centered empty state design in both ModelSelector and ModelManagement (gap closed)
3. Sidebar download indicator shows pulsing download icon instead of dot (gap closed)
4. Ollama settings page uses distinct panels for three sections with clear names (gap closed)
5. All styling matches Feeds page design patterns
6. No regressions in existing functionality
</verification>

<success_criteria>
- Model selectors use Chakra UI Select components with Portal/Positioner pattern
- Dropdowns don't cause layout shift when opened
- Disconnected states show centered empty-state design with icon and text
- Sidebar shows pulsing download icon during active downloads
- Ollama settings page has three distinct panels: Model Configuration, Model Library, System Prompts
- Panel design matches Feeds section styling (bg.subtle, borders, padding, spacing)
- All cosmetic gaps closed, UI feels polished and consistent
</success_criteria>

<output>
After completion, create `.planning/phases/07-ollama-configuration-ui/07-06-SUMMARY.md`
</output>
