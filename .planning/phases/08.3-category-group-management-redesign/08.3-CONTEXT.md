# Phase 08.3: Category Group Management Redesign - Context

**Gathered:** 2026-02-17
**Status:** Ready for planning

<domain>
## Phase Boundary

Replace drag-and-drop category grouping with a checkbox multi-select + action bar paradigm. Remove all DnD code for category management. Add collapsible tree, context menus, and clarified Delete/Hide/Block semantics. Mobile gets a card-based layout below the `sm` breakpoint.

</domain>

<decisions>
## Implementation Decisions

### Interaction paradigm
- **Multi-select with always-on checkboxes** on child and ungrouped category rows (not parents)
- **Desktop action header** always visible at top of categories section, buttons disabled when nothing selected. Layout: selection count left-aligned, action buttons right-aligned
- **Mobile floating bottom bar** slides up from bottom when 1+ items selected
- Action bar actions: **Move to group**, **Ungroup**, **Hide**, **Delete**
- "Move to group" opens a **modal dialog with search** listing existing parents + "Create new group" inline option. Same modal on all screen sizes
- **No select-all shortcuts** — manual checkbox selection only
- Block is NOT an action bar/menu action — it's a weight preset on the row's weight strip

### Tree structure
- **Keep tree view** with indented children and connector lines (same visual structure as 08.1/08.2, minus DnD)
- Parents are **collapsible** — click to expand/collapse
- Default state: **collapsed**, with expand/collapse state persisted in localStorage per device
- Children checkboxes only accessible when parent is expanded
- Collapsed parent shows: name, child count, weight preset strip (parents are categories with their own weights)
- **No DnD at all** — all grouping/ungrouping via action bar and context menu

### Context menu (⋮ per row)
- **Parent row:** Ungroup · Edit name · Hide · Delete
- **Child row:** Reset weight (disabled if same as parent) · Edit name · Hide · Delete
- **Ungrouped row:** Edit name · Hide · Delete
- "Ungroup" on parent = ungroup all children AND parent becomes ungrouped (no data deleted)
- Rename via hover-reveal pencil icon (same as current)

### Category removal semantics (Delete / Hide / Block)
- **Delete:** Category removed from DB, all article-category links removed. LLM no longer sees it in prompt. Purpose: cleanup of erroneous or too-specific categories
- **Hide:** Category exists in DB, flagged as hidden. LLM sees it in prompt but is instructed to never use it or adjacent categories. Purpose: content moderation (inappropriate terms). No scoring effect since it should never be assigned. Hiding clears the parent group assignment (category leaves its group immediately). Hidden categories move to a collapsible "Hidden (N)" section at bottom of categories list. Unhide returns category to ungrouped (parent was already cleared on hide)
- **Block (weight):** Normal category with block weight. LLM assigns it normally. If an article has AT LEAST ONE blocked category, the entire article skips scoring and is hidden in UI. Purpose: topic suppression for uninteresting subjects

### Confirmation and feedback
- **Confirmation dialogs** for both Delete and Ungroup actions (count only, e.g., "Delete 3 categories?")
- **Instant update + toast** after Move to group, Ungroup, Hide actions
- When parent is ungrouped, children that inherited the parent's weight get that weight set explicitly (preserves scoring behavior)

### Collapsed parent badges
- When a parent is collapsed and has new/unseen children, show a **"N new" chip** on the parent row
- Chip is clickable to dismiss (marks all children as seen), same interaction as individual row badges

### Mobile experience
- Below Chakra `sm` breakpoint (480px): **card layout** instead of rows
- Card structure: top row = checkbox + category name + ⋮ menu, bottom row = full weight preset strip (always visible, no expand/collapse)
- Child cards indented under parent cards with connector lines (same hierarchy visual)
- Floating bottom action bar slides up when items selected
- "Move to group" dialog: same centered modal on all screen sizes
- ⋮ context menu: same icon, tap to open popover/bottom sheet

### Terminology
- Use "Ungroup" consistently everywhere (not "Split")
- Action bar "Ungroup" = ungroup selected children
- Context menu "Ungroup" on parent = ungroup all children + parent becomes ungrouped

### Claude's Discretion
- Exact animation timing for floating action bar slide-in
- Card styling details (border, shadow, spacing) for mobile
- Connector line styling adjustments for card layout
- Confirmation dialog component choice (Chakra AlertDialog or custom)
- Touch target sizing for mobile checkboxes and ⋮ icons
- Search input behavior in "Move to group" dialog (debounce, filtering)

</decisions>

<specifics>
## Specific Ideas

- Action header layout mirrors common bulk-action patterns: count on left ("3 selected"), buttons on right
- Hidden section is a dedicated collapsible area at bottom, not inline dimming — keeps the active tree clean
- Cards on mobile give vertical room for full weight strip without cramming a single row
- "At least one blocked category" blocking rule is stricter than "only blocked" — any presence of a blocked tag filters the article

</specifics>

<deferred>
## Deferred Ideas

- **LLM parent category suggestion** — LLM auto-suggests existing parent for new categories during categorization. Deferred to Phase 9 (relates to pending todo #4: "Add category search tool for categorisation LLM")
- **DnD as supplementary interaction** — Could add optional DnD back later once core button-based paradigm is solid. Not in scope for 08.3

</deferred>

---

*Phase: 08.3-category-group-management-redesign*
*Context gathered: 2026-02-17*
