---
phase: 09.3-settings-page-architecture-research-and-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/09.3-settings-page-architecture-research-and-audit/09.3-FINDINGS.md
  - .planning/ROADMAP.md
  - .planning/STATE.md
autonomous: false
requirements: []

must_haves:
  truths:
    - "Settings component hierarchy is documented with annotated tree diagrams"
    - "Complexity hotspots are identified with specific metrics (line counts, prop counts, state variables)"
    - "Repeated UI patterns are catalogued with extraction targets and proposed APIs"
    - "Simplification recommendations are grouped by theme and prioritized"
    - "Phase 09.4 has concrete scope, success criteria, and plan breakdown in the roadmap"
    - "User has reviewed and approved the findings before they feed into Phase 09.4"
  artifacts:
    - path: ".planning/phases/09.3-settings-page-architecture-research-and-audit/09.3-FINDINGS.md"
      provides: "User-reviewable audit findings with recommendations grouped by theme"
    - path: ".planning/ROADMAP.md"
      provides: "Phase 09.4 updated with concrete scope from findings"
  key_links:
    - from: "09.3-RESEARCH.md"
      to: "09.3-FINDINGS.md"
      via: "Compilation and structuring of research into reviewable findings"
    - from: "09.3-FINDINGS.md"
      to: "ROADMAP.md Phase 09.4"
      via: "Recommendations become 09.4 scope and success criteria"
---

<objective>
Compile the completed research into a user-reviewable findings document, update Phase 09.4 in the roadmap with concrete scope derived from the findings, and get user approval before proceeding to implementation planning.

Purpose: The research (09.3-RESEARCH.md) is complete with full component hierarchy mapping, complexity hotspot analysis, repeated pattern catalogue, and themed recommendations. This plan compiles those findings into a presentation-ready format and updates the roadmap so Phase 09.4 has actionable scope.

Output: 09.3-FINDINGS.md (user-reviewable), updated ROADMAP.md (Phase 09.4 scoped), updated STATE.md
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09.3-settings-page-architecture-research-and-audit/09.3-RESEARCH.md
@.planning/phases/09.3-settings-page-architecture-research-and-audit/09.3-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Compile findings document and update roadmap Phase 09.4</name>
  <files>
    .planning/phases/09.3-settings-page-architecture-research-and-audit/09.3-FINDINGS.md
    .planning/ROADMAP.md
    .planning/STATE.md
  </files>
  <action>
Create `09.3-FINDINGS.md` by compiling the key findings from `09.3-RESEARCH.md` into a user-reviewable format. Structure:

1. **Executive Summary** -- 3-4 sentences on overall architecture health, primary hotspots, and key recommendation themes
2. **Component Hierarchy** -- Copy the annotated tree diagram from RESEARCH.md (the user explicitly requested tree diagrams for at-a-glance understanding)
3. **Complexity Hotspots** -- Summarize the 3 hotspots (CategoriesSection, ModelManagement, ModelSelector) with metrics (line counts, prop counts, state variables)
4. **Repeated Patterns** -- List the 5 repeated patterns with usage counts and proposed extraction targets (SettingsPanel, EmptyState, inline progress bars, inline Dialog.Root, heading inconsistency)
5. **Recommendations by Theme** -- Present the 5 recommendation themes (A: Shared Layout Primitives, B: Category Section Simplification, C: Ollama Section Cleanup, D: Heading Consistency, E: Mobile Nav Fix) with before/after tree diagrams for Theme B
6. **Dead Code** -- Note OllamaPlaceholder.tsx for deletion
7. **What's Already Good** -- Highlight the patterns that should NOT change (App Router routing, server/client boundaries, TanStack Query usage, React.memo placement)
8. **Open Questions** -- Copy the 2 open questions from research for user input

Then update ROADMAP.md Phase 09.4 entry:
- Set **Goal** to: "Implement settings architecture simplifications -- shared layout primitives, category section decomposition, ollama section cleanup, and consistency fixes"
- Set **Depends on**: Phase 09.3
- Set **Success Criteria** derived from the 5 recommendation themes:
  1. SettingsPanel shared component replaces 7+ inline card wrappers across all settings sections
  2. EmptyState shared component replaces 4+ inline empty state blocks
  3. CategoriesSection reduced from ~491 to ~200 lines via useCategoryTree hook, CategoryTreeContext, and useCategoryDialogs hook
  4. CategoryTree prop count reduced from 15 to ~5 (data only), row components from 10-12 to 3-5 (via context)
  5. ModelManagement uses ConfirmDialog instead of inline Dialog.Root
  6. ModelSelector uses ModelPullProgress compact (or extracted DownloadProgressBar) instead of 3 inline progress bars
  7. All page titles use consistent fontSize="xl"
  8. SettingsMobileNav includes "General" section
  9. OllamaPlaceholder.tsx dead code deleted
  10. No functional regressions -- all existing behavior preserved
- Add plan placeholders grouped by the recommendation themes:
  - Plan 01: Shared layout primitives (Theme A) -- SettingsPanel, EmptyState, dead code cleanup
  - Plan 02: Category section decomposition (Theme B) -- useCategoryTree, CategoryTreeContext, useCategoryDialogs
  - Plan 03: Ollama section cleanup + consistency fixes (Theme C + D + E) -- ConfirmDialog, progress bars, headings, mobile nav

Also update STATE.md:
- Current position: Phase 09.3 in progress
- Note that findings are ready for user review
  </action>
  <verify>
- `09.3-FINDINGS.md` exists and contains all 8 sections listed above
- ROADMAP.md Phase 09.4 has concrete Goal, Success Criteria (10 items), and 3 plan placeholders
- STATE.md updated with current position
  </verify>
  <done>
Findings document is complete with hierarchy diagrams, hotspot metrics, pattern catalogue, themed recommendations, and open questions. Phase 09.4 has concrete scope in the roadmap.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: User reviews findings and approves Phase 09.4 scope</name>
  <action>
Present the compiled findings to the user for review. The user wants to review findings before they feed into Phase 09.4 planning. Key review points:
- 5 recommendation themes (A: Shared Layout Primitives, B: Category Section Simplification, C: Ollama Section Cleanup, D: Heading Consistency, E: Mobile Nav Fix)
- Phase 09.4 scope and success criteria in ROADMAP.md
- Open questions on CategoryRowShell memoization and WeightPresetStrip hover state
  </action>
  <verify>
1. Read `.planning/phases/09.3-settings-page-architecture-research-and-audit/09.3-FINDINGS.md`
2. Review the 5 recommendation themes -- do they capture the right simplifications?
3. Check the Phase 09.4 scope in `.planning/ROADMAP.md` -- are the success criteria and plan groupings reasonable?
4. Review the "Open Questions" section -- provide input on CategoryRowShell memoization and WeightPresetStrip hover state if you have an opinion
5. Flag any recommendations you want to defer, modify, or add
  </verify>
  <done>User has reviewed findings and either approved them or provided feedback for revision. Phase 09.3 audit is complete.</done>
</task>

</tasks>

<verification>
1. `09.3-FINDINGS.md` exists with all required sections
2. ROADMAP.md Phase 09.4 has concrete scope (not placeholder "TBD")
3. User has reviewed and approved findings
4. STATE.md reflects current phase status
</verification>

<success_criteria>
- User-reviewable findings document produced from research
- Phase 09.4 has actionable scope derived from findings
- User has approved findings and 09.4 scope before implementation begins
</success_criteria>

<output>
After completion, create `.planning/phases/09.3-settings-page-architecture-research-and-audit/09.3-01-SUMMARY.md`
</output>
