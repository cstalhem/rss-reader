---
phase: 09.5-refine-main-view-ux-and-typography
plan: 02
subsystem: ui
tags: [layout, sidebar, header, chakra-ui, next.js]

# Dependency graph
requires: []
provides:
  - "Headerless layout shell with sidebar as primary navigation chrome"
  - "Sidebar with logo/brand, scrollable feeds, bottom-pinned settings+theme+collapse"
  - "Collapsed sidebar icon-only layout with feed initials"
  - "MobileSidebar with logo, settings, and theme toggle"
  - "onOpenMobileSidebar prop threaded through AppShell to ArticleList"
affects: [09.5-03, 09.5-04, 09.5-05]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Three-zone sidebar layout: logo top, scrollable feeds middle, pinned utilities bottom"
    - "Collapsed sidebar icon-only mode with feed initial circles"

key-files:
  created: []
  modified:
    - "frontend/src/components/layout/Sidebar.tsx"
    - "frontend/src/components/layout/AppShell.tsx"
    - "frontend/src/components/layout/MobileSidebar.tsx"
    - "frontend/src/lib/constants.ts"
    - "frontend/src/components/article/ArticleList.tsx"
    - "frontend/src/app/settings/layout.tsx"

key-decisions:
  - "Sidebar uses Circle with feed initial letter for collapsed feed items"
  - "Settings dot badge query moved from Header to both Sidebar and MobileSidebar"
  - "Settings layout adjusted to remove header offset (pt and maxH recalculated)"

patterns-established:
  - "Three-zone sidebar: logo (top), feeds (middle, scrollable), utilities (bottom, pinned)"

requirements-completed: []

# Metrics
duration: 4.1min
completed: 2026-02-22
---

# Phase 09.5 Plan 02: Layout Shell Restructure Summary

**Removed top header bar, restructured sidebar with logo/feeds/utilities zones, added collapsed icon-only state with feed initials**

## Performance

- **Duration:** 4.1 min
- **Started:** 2026-02-22T20:23:11Z
- **Completed:** 2026-02-22T20:27:20Z
- **Tasks:** 2
- **Files modified:** 7 (including Header.tsx deletion)

## Accomplishments
- Sidebar now spans full viewport height with three zones: logo at top, scrollable feeds in middle, settings + theme + collapse toggle pinned at bottom
- Collapsed sidebar shows icon-only layout with RSS icon logo, feed initials in circles, and utility icons
- Header.tsx deleted; its responsibilities (logo, settings icon with dot badge, theme toggle, mobile hamburger) redistributed to Sidebar and MobileSidebar
- MobileSidebar drawer enhanced with logo heading and settings/theme toggle in footer
- Main content area starts at top of viewport with no padding offset

## Task Commits

Each task was committed atomically:

1. **Task 1: Restructure Sidebar with logo, bottom-pinned utilities, and collapsed icon-only state** - `0df4ac8` (feat)
2. **Task 2: Remove Header, update AppShell layout, and update MobileSidebar** - `e733d43` (feat)

## Files Created/Modified
- `frontend/src/components/layout/Sidebar.tsx` - Restructured with three-zone layout (logo, feeds, pinned utilities) and collapsed icon-only state
- `frontend/src/components/layout/AppShell.tsx` - Removed Header import/rendering, removed HEADER_HEIGHT padding, passes onOpenMobileSidebar to ArticleList
- `frontend/src/components/layout/Header.tsx` - **Deleted** (responsibilities moved to Sidebar and MobileSidebar)
- `frontend/src/components/layout/MobileSidebar.tsx` - Added logo heading, settings link with dot badge, and theme toggle in drawer footer
- `frontend/src/components/article/ArticleList.tsx` - Added onOpenMobileSidebar prop to interface (unused until Plan 03)
- `frontend/src/lib/constants.ts` - Removed HEADER_HEIGHT export
- `frontend/src/app/settings/layout.tsx` - Removed Header import/rendering, adjusted padding

## Decisions Made
- Feed initials shown in Circle components for collapsed sidebar (simple and readable)
- New category count query duplicated in both Sidebar and MobileSidebar (shared TanStack Query cache deduplicates)
- Settings layout padding adjusted from pt="88px" to no top padding and maxH simplified

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] Updated settings layout to remove Header dependency**
- **Found during:** Task 2 (Header deletion)
- **Issue:** Settings layout (`frontend/src/app/settings/layout.tsx`) also imported and rendered Header with HEADER_HEIGHT-based padding
- **Fix:** Removed Header import/rendering, adjusted `pt` and `maxH` to remove header offset
- **Files modified:** `frontend/src/app/settings/layout.tsx`
- **Verification:** ESLint clean, no remaining Header/HEADER_HEIGHT references in codebase
- **Committed in:** e733d43 (Task 2 commit)

---

**Total deviations:** 1 auto-fixed (1 blocking)
**Impact on plan:** Essential fix to prevent build breakage from Header deletion. No scope creep.

## Issues Encountered
- Pre-existing TypeScript error in `useCompletingArticles.ts` (Article vs ArticleListItem type mismatch) prevents clean `bun run build`. Verified unrelated to this plan's changes via targeted eslint and tsc checks on modified files.

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Layout shell restructured and ready for Plan 03 (controls bar, feed heading, mobile hamburger)
- ArticleList accepts onOpenMobileSidebar prop, ready to render mobile hamburger trigger
- Sidebar collapsed state ready for visual refinement in later plans

---
*Phase: 09.5-refine-main-view-ux-and-typography*
*Completed: 2026-02-22*
